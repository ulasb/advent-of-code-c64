# Advent of Code 2016 - Day 9 (C64 Edition)

This is a Commodore 64 implementation of Advent of Code 2016 Day 9, written in C and compiled with cc65.

## The Problem

**Day 9: Explosives in Cyberspace**

The challenge is to calculate the decompressed length of a custom compression format.
- **Part 1:** Decompress using version 1 rules (markers are not recursive). ✅ **Implemented**
- **Part 2:** Decompress using version 2 rules (recursive markers). ✅ **Implemented**

## Running the Program

### Requirements
- [cc65](https://cc65.github.io/) compiler suite
- [VICE](https://vice-emu.sourceforge.io/) or another C64 emulator (like `x64`)

### Compilation
To compile the program, run:
```bash
make
```
This produces `day9.prg`.

### Testing
To run it in VICE:
```bash
make run
```
Or load `day9.prg` manually into your emulator.

The program will run automated tests and display results on screen. Press Enter to exit when complete.

## Test Cases Included

We use hardcoded test cases derived from the problem description and the original Python implementation.

### Part 1 Tests
- `ADVENT` -> 6
- `A(1x5)BC` -> 7
- `(3x3)XYZ` -> 9
- `A(2x2)BCD(2x2)EFG` -> 11
- `(6x1)(1x3)A` -> 6
- `X(8x2)(3x3)ABCY` -> 18

### Part 2 Tests
- `(3x3)XYZ` -> 9
- `X(8x2)(3x3)ABCY` -> 20
- `(27x12)(20x12)(13x14)(7x10)(1x12)A` -> 241920
- `(25x3)(3x3)ABC(2x3)XY(5x2)PQRSTX(18x9)(3x2)TWO(5x7)SEVEN` -> 445

## Technical Notes

### Algorithm

The implementation ports the logic from the Python solution:
- **Part 1:** Linear scan, parsing markers `(LxR)` and calculating length.
- **Part 2:** Recursive scan, processing markers within markers.

### Implementation Improvements

#### 1. Robust Parsing
We use `sscanf` to parse compression markers `(LxR)`. This is more robust than manual parsing as it validates the format and handles potential malformed input gracefully by checking the return value.

#### 2. Portability and Integer Safety
The implementation uses `size_t` for all string indices and lengths. This ensures portability and prevents potential overflow issues on platforms where `unsigned int` might be smaller than the addressable memory space.

#### 3. String Truncation
String truncation for test output is handled safely via `snprintf`, avoiding manual buffer manipulation and potential errors.

#### 4. conio.h for Output
Following the project standard, we use `conio.h` for stable and persistent screen output.

## Files
- `day9.c` - Main source code
- `Makefile` - Build script
- `README.md` - This file
- `day9.prg` - Compiled C64 executable (generated by `make`)
